{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\z00s600199\\\\OJT\\\\my-app-typescript\\\\src\\\\App.tsx\";\nimport React from 'react';\nimport * as fs from 'fs';\nimport { createFFmpeg, fetchFile } from '@ffmpeg/ffmpeg';\nimport './App.css';\n\nclass MovieForm extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleSubmit = event => {\n      event.preventDefault();\n      const result = this.videoConverter(this.state.file);\n      result.then(result => {\n        fs.writeFile(\"audio.wav\", result, err => {\n          if (err) throw err;\n          console.log('正常に書き込みが完了しました');\n        });\n      });\n    };\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  getFileInput(file) {\n    return new Promise(function (resolve, reject) {\n      const reader = new FileReader();\n      reader.onerror = reject;\n\n      reader.onload = function () {\n        resolve(reader.result);\n      };\n\n      reader.readAsBinaryString(file); // here the file can be read in different way Text, DataUrl, ArrayBuffer\n    });\n  }\n\n  manageUploadedFile(binary, file) {\n    console.log('the file size is ' + binary.length);\n    console.log('the file name is ' + file.name);\n    this.setState({\n      file: file\n    });\n  }\n\n  async videoConverter(file) {\n    const ffmpeg = createFFmpeg({\n      log: true\n    });\n    await ffmpeg.load();\n    ffmpeg.FS('writeFile', file.name, await fetchFile(file));\n    await ffmpeg.run('-i', file.name, 'audio.wav');\n    return ffmpeg.FS('readFile', 'audio.wav');\n  }\n\n  handleChange(event) {\n    if (event.target.files !== null) {\n      Array.from(event.target.files).forEach(file => {\n        this.getFileInput(file).then(binary => {\n          if (typeof binary === 'string') {\n            this.manageUploadedFile(binary, file);\n          } else {\n            console.log(\"binary is not string\");\n          }\n        }).catch(function (reason) {\n          console.log('error during upload ${reason}');\n          event.target.value = '';\n        });\n      });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: this.handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: [\"Name:\", /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            accept: \"video/mp4\",\n            onChange: this.handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"submit\",\n          value: \"Submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 5\n    }, this);\n  }\n\n}\n\nexport default MovieForm;","map":{"version":3,"sources":["C:/Users/z00s600199/OJT/my-app-typescript/src/App.tsx"],"names":["React","fs","createFFmpeg","fetchFile","MovieForm","Component","constructor","props","handleSubmit","event","preventDefault","result","videoConverter","state","file","then","writeFile","err","console","log","handleChange","bind","getFileInput","Promise","resolve","reject","reader","FileReader","onerror","onload","readAsBinaryString","manageUploadedFile","binary","length","name","setState","ffmpeg","load","FS","run","target","files","Array","from","forEach","catch","reason","value","render"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport ReactDom from 'react-dom';\r\nimport * as fs from 'fs';\r\nimport { createFFmpeg, fetchFile } from '@ffmpeg/ffmpeg';\r\nimport './App.css';\r\nimport { fireEvent, render } from '@testing-library/react';\r\nimport { fileURLToPath } from 'url';\r\n\r\n\r\ninterface SquarePropsInterface {\r\n}\r\n\r\ninterface SquareStateInterface {\r\n  file: File;\r\n}\r\n\r\n\r\n\r\nclass MovieForm extends React.Component<SquarePropsInterface, SquareStateInterface> {\r\n  constructor(props:SquarePropsInterface) {\r\n    super(props);\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.handleSubmit = this.handleSubmit.bind(this);\r\n  }\r\n  private getFileInput(file:File): Promise<string | ArrayBuffer | null> {\r\n    return new Promise(function (resolve, reject) {\r\n      const reader = new FileReader();\r\n      reader.onerror = reject;\r\n      reader.onload = function () { resolve(reader.result); };\r\n      reader.readAsBinaryString(file); // here the file can be read in different way Text, DataUrl, ArrayBuffer\r\n  });\r\n  }\r\n\r\n  private manageUploadedFile(binary:string, file: File) {\r\n    console.log('the file size is '+binary.length);\r\n    console.log('the file name is '+file.name);\r\n    this.setState({\r\n      file:file,\r\n    });\r\n  }\r\n\r\n  private async videoConverter(file:File):Promise<File> {\r\n      const ffmpeg = createFFmpeg({\r\n        log: true,\r\n      });\r\n      \r\n      await ffmpeg.load();\r\n      ffmpeg.FS('writeFile',file.name,await fetchFile(file));\r\n      await ffmpeg.run('-i',file.name, 'audio.wav');\r\n      return ffmpeg.FS('readFile','audio.wav');\r\n    \r\n  }\r\n  private handleChange(event:React.ChangeEvent<HTMLInputElement>) {\r\n    if (event.target.files !== null) {\r\n      Array.from(event.target.files).forEach(file => {\r\n        this.getFileInput(file)\r\n          .then((binary) => {\r\n            if (typeof binary === 'string'){\r\n              this.manageUploadedFile(binary,file);\r\n            } else {\r\n              console.log(\"binary is not string\");\r\n            }\r\n          }).catch(function (reason) {\r\n            console.log('error during upload ${reason}');\r\n            event.target.value = '';\r\n          })\r\n      })\r\n    }\r\n  }\r\n  handleSubmit = (event:React.FormEvent<HTMLFormElement>):void => {\r\n    event.preventDefault();\r\n    const result = this.videoConverter(this.state.file);\r\n    result.then((result) => {\r\n      fs.writeFile(\"audio.wav\", result, (err) => {\r\n        if (err) throw err;\r\n        console.log('正常に書き込みが完了しました');\r\n      });\r\n    })\r\n    \r\n  }\r\n  render() {\r\n    return (\r\n    <div>\r\n      <form onSubmit={this.handleSubmit}>\r\n        <label>\r\n          Name:\r\n          <input type=\"file\" accept = \"video/mp4\" onChange={this.handleChange} />\r\n        </label>\r\n        <input type=\"submit\" value=\"Submit\" />\r\n      </form>\r\n    </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default MovieForm;\r\n\r\n"]},"metadata":{},"sourceType":"module"}