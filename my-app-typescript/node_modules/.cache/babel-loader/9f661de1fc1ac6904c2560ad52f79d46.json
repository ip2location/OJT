{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\z00s600199\\\\OJT\\\\my-app-typescript\\\\src\\\\App.tsx\";\nimport React from 'react';\nimport './App.css';\n\nclass MovieForm extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.handleSubmit = event => {//console.log('submit file' + this.state.fileName);\n    };\n\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  getFileInput(file) {\n    //anyは後で直したい\n    return new Promise(function (resolve, reject) {\n      const reader = new FileReader();\n      reader.onerror = reject;\n\n      reader.onload = function () {\n        resolve(reader.result);\n      };\n\n      reader.readAsBinaryString(file); // here the file can be read in different way Text, DataUrl, ArrayBuffer\n    });\n  }\n\n  manageUploadedFile(binary, file) {\n    console.log('the file size is ' + binary.length);\n    console.log('the file name is ' + file.name);\n    this.setState({\n      fileName: binary\n    });\n  }\n\n  handleChange(event) {\n    /*\r\n    const ffmpeg = createFFmpeg({\r\n      log: true,\r\n    });\r\n    \r\n    ffmpeg.load();\r\n    //@ts-ignore\r\n    ffmpeg.FS('writeFile','video.mp4',await fetchFile(event.target.files[0]));\r\n    ffmpeg.run('-i', 'video.mp4', 'audio.wav');\r\n    //errorハンドリングしてない、なんでエラー\r\n    //ffmpeg.FS('readFile','audio.wav');\r\n    Download();\r\n    //downloadしたい\r\n    \r\n    function Download() {\r\n      return <a id=\"download\" href=\"#\" download=\"./audio.wav\"></a>;\r\n    }\r\n    */\n    //event.persist(); 参考にしたページにはあったがなくても動く\n    if (event.target.files !== null) {\n      Array.from(event.target.files).forEach(file => {\n        this.getFileInput(file).then(binary => {\n          if (typeof binary === 'string') {\n            this.manageUploadedFile(binary, file);\n          } else {\n            console.log(\"binary is not string\");\n          }\n        }).catch(function (reason) {\n          console.log('error during upload ${reason}');\n          event.target.value = '';\n        });\n      });\n    } //this.setState({value: event.target.value});\n\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: this.handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: [\"Name:\", /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            accept: \"video/mp4\",\n            onChange: this.handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"submit\",\n          value: \"Submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 5\n    }, this);\n  }\n\n}\n\nexport default MovieForm;","map":{"version":3,"sources":["C:/Users/z00s600199/OJT/my-app-typescript/src/App.tsx"],"names":["React","MovieForm","Component","constructor","props","handleSubmit","event","handleChange","bind","getFileInput","file","Promise","resolve","reject","reader","FileReader","onerror","onload","result","readAsBinaryString","manageUploadedFile","binary","console","log","length","name","setState","fileName","target","files","Array","from","forEach","then","catch","reason","value","render"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AAIA,OAAO,WAAP;;AAeA,MAAMC,SAAN,SAAwBD,KAAK,CAACE,SAA9B,CAAoF;AAClFC,EAAAA,WAAW,CAACC,KAAD,EAA6B;AACtC,UAAMA,KAAN;;AADsC,SA0DxCC,YA1DwC,GA0DxBC,KAAD,IAAiD,CAC9D;AACD,KA5DuC;;AAEtC,SAAKC,YAAL,GAAoB,KAAKA,YAAL,CAAkBC,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAKH,YAAL,GAAoB,KAAKA,YAAL,CAAkBG,IAAlB,CAAuB,IAAvB,CAApB;AACD;;AACOC,EAAAA,YAAR,CAAqBC,IAArB,EAAsE;AAAC;AACrE,WAAO,IAAIC,OAAJ,CAAY,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;AAC5C,YAAMC,MAAM,GAAG,IAAIC,UAAJ,EAAf;AACAD,MAAAA,MAAM,CAACE,OAAP,GAAiBH,MAAjB;;AACAC,MAAAA,MAAM,CAACG,MAAP,GAAgB,YAAY;AAAEL,QAAAA,OAAO,CAACE,MAAM,CAACI,MAAR,CAAP;AAAyB,OAAvD;;AACAJ,MAAAA,MAAM,CAACK,kBAAP,CAA0BT,IAA1B,EAJ4C,CAIX;AACpC,KALQ,CAAP;AAMD;;AAEOU,EAAAA,kBAAR,CAA2BC,MAA3B,EAA0CX,IAA1C,EAAsD;AACpDY,IAAAA,OAAO,CAACC,GAAR,CAAY,sBAAoBF,MAAM,CAACG,MAAvC;AACAF,IAAAA,OAAO,CAACC,GAAR,CAAY,sBAAoBb,IAAI,CAACe,IAArC;AACA,SAAKC,QAAL,CAAc;AACZC,MAAAA,QAAQ,EAACN;AADG,KAAd;AAGD;;AACOd,EAAAA,YAAR,CAAqBD,KAArB,EAAgE;AAC9D;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACI;AACA,QAAIA,KAAK,CAACsB,MAAN,CAAaC,KAAb,KAAuB,IAA3B,EAAiC;AAC/BC,MAAAA,KAAK,CAACC,IAAN,CAAWzB,KAAK,CAACsB,MAAN,CAAaC,KAAxB,EAA+BG,OAA/B,CAAuCtB,IAAI,IAAI;AAC7C,aAAKD,YAAL,CAAkBC,IAAlB,EACGuB,IADH,CACSZ,MAAD,IAAY;AAChB,cAAI,OAAOA,MAAP,KAAkB,QAAtB,EAA+B;AAC7B,iBAAKD,kBAAL,CAAwBC,MAAxB,EAA+BX,IAA/B;AACD,WAFD,MAEO;AACLY,YAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ;AACD;AACF,SAPH,EAOKW,KAPL,CAOW,UAAUC,MAAV,EAAkB;AACzBb,UAAAA,OAAO,CAACC,GAAR,CAAY,+BAAZ;AACAjB,UAAAA,KAAK,CAACsB,MAAN,CAAaQ,KAAb,GAAqB,EAArB;AACD,SAVH;AAWD,OAZD;AAaD,KAlC6D,CAmC5D;;AACH;;AAIDC,EAAAA,MAAM,GAAG;AACP,wBACA;AAAA,6BACE;AAAM,QAAA,QAAQ,EAAE,KAAKhC,YAArB;AAAA,gCACE;AAAA,2CAEE;AAAO,YAAA,IAAI,EAAC,MAAZ;AAAmB,YAAA,MAAM,EAAG,WAA5B;AAAwC,YAAA,QAAQ,EAAE,KAAKE;AAAvD;AAAA;AAAA;AAAA;AAAA,kBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAKE;AAAO,UAAA,IAAI,EAAC,QAAZ;AAAqB,UAAA,KAAK,EAAC;AAA3B;AAAA;AAAA;AAAA;AAAA,gBALF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YADA;AAWD;;AA1EiF;;AA6EpF,eAAeN,SAAf","sourcesContent":["import React from 'react';\r\nimport ReactDom from 'react-dom';\r\nimport * as fs from 'fs';\r\nimport { createFFmpeg, fetchFile } from '@ffmpeg/ffmpeg';\r\nimport './App.css';\r\nimport { render } from '@testing-library/react';\r\nimport { fileURLToPath } from 'url';\r\n\r\n\r\ninterface SquarePropsInterface {\r\n}\r\n\r\ninterface SquareStateInterface {\r\n  file: File;\r\n  fileName: string;\r\n}\r\n\r\n\r\n\r\nclass MovieForm extends React.Component<SquarePropsInterface, SquareStateInterface> {\r\n  constructor(props:SquarePropsInterface) {\r\n    super(props);\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.handleSubmit = this.handleSubmit.bind(this);\r\n  }\r\n  private getFileInput(file:File): Promise<string | ArrayBuffer | null> {//anyは後で直したい\r\n    return new Promise(function (resolve, reject) {\r\n      const reader = new FileReader();\r\n      reader.onerror = reject;\r\n      reader.onload = function () { resolve(reader.result); };\r\n      reader.readAsBinaryString(file); // here the file can be read in different way Text, DataUrl, ArrayBuffer\r\n  });\r\n  }\r\n\r\n  private manageUploadedFile(binary:string, file: File) {\r\n    console.log('the file size is '+binary.length);\r\n    console.log('the file name is '+file.name);\r\n    this.setState({\r\n      fileName:binary,\r\n    });\r\n  }\r\n  private handleChange(event:React.ChangeEvent<HTMLInputElement>) {\r\n    /*\r\n    const ffmpeg = createFFmpeg({\r\n      log: true,\r\n    });\r\n    \r\n    ffmpeg.load();\r\n    //@ts-ignore\r\n    ffmpeg.FS('writeFile','video.mp4',await fetchFile(event.target.files[0]));\r\n    ffmpeg.run('-i', 'video.mp4', 'audio.wav');\r\n    //errorハンドリングしてない、なんでエラー\r\n    //ffmpeg.FS('readFile','audio.wav');\r\n    Download();\r\n    //downloadしたい\r\n    \r\n    function Download() {\r\n      return <a id=\"download\" href=\"#\" download=\"./audio.wav\"></a>;\r\n    }\r\n    */\r\n    //event.persist(); 参考にしたページにはあったがなくても動く\r\n    if (event.target.files !== null) {\r\n      Array.from(event.target.files).forEach(file => {\r\n        this.getFileInput(file)\r\n          .then((binary) => {\r\n            if (typeof binary === 'string'){\r\n              this.manageUploadedFile(binary,file);\r\n            } else {\r\n              console.log(\"binary is not string\");\r\n            }\r\n          }).catch(function (reason) {\r\n            console.log('error during upload ${reason}');\r\n            event.target.value = '';\r\n          })\r\n      })\r\n    }\r\n      //this.setState({value: event.target.value});\r\n  }\r\n  handleSubmit = (event:React.FormEvent<HTMLFormElement>):void => {\r\n    //console.log('submit file' + this.state.fileName);\r\n  }\r\n  render() {\r\n    return (\r\n    <div>\r\n      <form onSubmit={this.handleSubmit}>\r\n        <label>\r\n          Name:\r\n          <input type=\"file\" accept = \"video/mp4\" onChange={this.handleChange} />\r\n        </label>\r\n        <input type=\"submit\" value=\"Submit\" />\r\n      </form>\r\n    </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default MovieForm;\r\n\r\n"]},"metadata":{},"sourceType":"module"}